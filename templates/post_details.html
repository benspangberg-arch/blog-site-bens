{% extends "base.html" %}
{% block content %}
  <h2>{{ post.title }}</h2>
  <p>{{ post.content }}</p>

  <p>
    {% if post.author %}
      <strong>Author:</strong> {{ post.author.username }}
    {% else %}
      <strong>Author:</strong> anonymous
    {% endif %}
  </p>

  <p>
    <a class="btn" href="{{ url_for('edit_post', post_id=post.id) }}">Edit</a>

    <form method="POST" action="{{ url_for('delete_post', post_id=post.id) }}" style="display:inline-block;">
      <button type="submit" onclick="return confirm('Delete this post?')">Delete</button>
    </form>
  </p>

  <hr>
  <h3>Comments</h3>
  <ul class="items">
    {% for c in post.comments %}
      <li>{{ c.body }}{% if c.author %} â€” <small>{{ c.author.username }}</small>{% endif %}</li>
    {% else %}
      <li>No comments yet.</li>
    {% endfor %}
  </ul>

  <h4>Add a comment if you want</h4>
  <form method="POST" action="{{ url_for('add_comment', post_id=post.id) }}">
    <textarea name="body" rows="3" required></textarea>
    <div>
      <label>Comment as (optional)</label>
      <select name="user_id">
        <option value="">-- anonymous --</option>
        {% for u in users %}
          <option value="{{ u.id }}">{{ u.username }}</option>
        {% endfor %}
      </select>
    </div>
    <button type="submit">Add comment</button>
  </form>
{% endblock %}
